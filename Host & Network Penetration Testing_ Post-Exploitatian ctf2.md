<span style="color: #000000;">This lab involves exploiting a Windows target machine. By identifying insecure configurations, cracking hashes, and leveraging privilege escalation techniques, you'll uncover and capture the flags. Challenges include exploiting an insecure SSH user, cracking password hashes, escalating privileges, and overcoming restricted access to files.</span>

# Lab Environment

A target machine is accessible at **target.ine.local.** Identify the services and capture the flags.

- **Flag 1:** An insecure SSH user named **alice** lurks in the system.
- **Flag 2:** Using the hashdump file discovered in the previous challenge, can you crack the hashes and compromise a user?
- **Flag 3:** Can you escalate privileges and read the flag in C://Windows//System32//config directory?
- **Flag 4:** Looks like the flag present in the Administrator's home denies direct access.

The following will be useful:

- **Wordist:** /usr/share/wordlists/metasploit/unix_passwords.txt
- **Tool:** /root/Desktop/PrintSpoofer.exe

# Tools

- Nmap
- Hydra
- JohnTheRipper
- PrintSpoofer

**Flag 1: An insecure SSH user named Alice lurks in the system.**

<span style="color: #000000;"><span>Find the ip use below commands</span></span>

cat /etc/hosts

arp -a

dig target.ine.local

nslookup target.ine.local

ping target.ine.local

![c3ab53de117e64d8bdc12e2b8f1f06ab.png](resources/c3ab53de117e64d8bdc12e2b8f1f06ab.png)

Do nmap

nmap -p- -sC -sV 10.3.26.100 -vvv nmap full

![35ac5bba4bce3b844f28939cb9c6ec84.png](resources/35ac5bba4bce3b844f28939cb9c6ec84.png)

We got the user name as Alice on the question. Let's do the brute force

![3568b01633cacb36e8edb3ec08281915.png](resources/3568b01633cacb36e8edb3ec08281915.png)

Now we are in Alice's server

![1f58e3a43455986d10b0eb6f13b26b4e.png](resources/1f58e3a43455986d10b0eb6f13b26b4e.png)

![ed065ed2807d3d362f2dfab33607c785.png](resources/ed065ed2807d3d362f2dfab33607c785.png)

![6ee97998cd618c940b6c1ef97fa0c6fd.png](resources/6ee97998cd618c940b6c1ef97fa0c6fd.png)

&nbsp;

**Flag 2: Using the hashdump file discovered in the previous challenge, can you crack the hashes and compromise a user?”**

Let's download the hashdump file via SSH with scp.

scp alice@10.3.28.8:hashdump.txt hash.txt

![e5e7328e262654a68dade7dc0a1a2367.png](resources/e5e7328e262654a68dade7dc0a1a2367.png)

![58f5b3ca5779cdb3addb2e675acb519b.png](resources/58f5b3ca5779cdb3addb2e675acb519b.png)

We have a hash file like this.

run john --format=NT hash.txt file

![a19b565e81ddd2fe7c069f24a5ae4db6.png](resources/a19b565e81ddd2fe7c069f24a5ae4db6.png)

Log in, David with SSH and find the flag2

SSH david@target.ine.local

![b5c861341e62f9694248680d13bfea81.png](resources/b5c861341e62f9694248680d13bfea81.png)

![3307c4ec6f9e78df70a926c3551d9da0.png](resources/3307c4ec6f9e78df70a926c3551d9da0.png)

![730504f006f40f14783f490b6d1ab654.png](resources/730504f006f40f14783f490b6d1ab654.png)

&nbsp;**flag3: Can you escalate privileges and read the flag in C://Windows//System32//config directory?**

open msfconsole

search SSH_log in and use

![7fa5aa69b81f59a8bbb7a995f07022f3.png](resources/7fa5aa69b81f59a8bbb7a995f07022f3.png)

![fbaf39af1e9ffaf964314cd56a36edd8.png](resources/fbaf39af1e9ffaf964314cd56a36edd8.png)

set up sessions

![08b1e1cdd88d031694a1b6720ab96b12.png](resources/08b1e1cdd88d031694a1b6720ab96b12.png)

![84af786bb27d61b4a3cb32264429f5b3.png](resources/84af786bb27d61b4a3cb32264429f5b3.png)

![dbb09441d0dab38639d2b28d99816e39.png](resources/dbb09441d0dab38639d2b28d99816e39.png)

![1822bc02963b7d4dca0f189e75ff4063.png](resources/1822bc02963b7d4dca0f189e75ff4063.png)

type getsystem

and copy to path from question and paste C://Windows//System32//config

![412faa9dec75de1de2216050d128c063.png](resources/412faa9dec75de1de2216050d128c063.png)

![88129a3973e3dd22f1da17c41272d0f2.png](resources/88129a3973e3dd22f1da17c41272d0f2.png)

- **Flag 4: Looks like the flag present in the Administrator's home denies direct access.**

&nbsp;![21a1004c31052847ed11aa61382d337c.png](resources/21a1004c31052847ed11aa61382d337c.png)

&nbsp;![f3192198a6428e094a0b82c09b7bd089.png](resources/f3192198a6428e094a0b82c09b7bd089.png)

![4b4d05a562383c17a8ca113f0c15f3df.png](resources/4b4d05a562383c17a8ca113f0c15f3df.png)

We need to open a shell and try to find the flag directory

Access is denied and requires privileged escalation. I used to net command and added a new password.

![007540593b51a146001cbc37e0552a89.png](resources/007540593b51a146001cbc37e0552a89.png)


C:\\Users\\Administrator>net user Administrator Newpass  
\==> This command is used in Windows Command Prompt to change the password of the **Administrator** account. Here’s a breakdown:

- **`net user`** – This is a built-in Windows command to manage user accounts.
- **`Administrator`** – This specifies the user account whose password you want to change.
- **`Newpass`** – This is the new password being set for the **Administrator** account.

### **Implications**

- If you have the necessary permissions, running this command will immediately change the **Administrator** password to `Newpass`.
- If executed in an elevated Command Prompt (Run as Administrator), it can be used to reset the password without requiring the old password.

&nbsp;

Once we change the Administrator password, we can log in with the  SSH server

For the below use Newpass

![811483e0f3988f06c186e204531cf85e.png](resources/811483e0f3988f06c186e204531cf85e.png)

![79fd4ccaa65cc1227f242e6a048bf040.png](resources/79fd4ccaa65cc1227f242e6a048bf040.png)
