### Completing Skill Check Labs

Skill Check Labs are interactive, hands-on exercises designed to validate the knowledge and skills you’ve gained in this course through real-world scenarios. Each lab presents practical tasks that require you to apply what you’ve learned. Unlike other INE labs, solutions are not provided, challenging you to demonstrate your understanding and problem-solving abilities. Your performance is graded, allowing you to track progress and measure skill growth over time.

# Lab Environment

Two Linux machines are accessible at **target1.ine.local** and **target2.ine.local**. Identify the application and service running on these machines, and capture the flags. The flag is an md5 hash format.

- **Flag 1:** Identify and exploit the vulnerable web application running on **target1.ine.local** and retrieve the flag from the root directory. The credentials **admin:password1** may be useful.
- **Flag 2:** Further, identify and compromise an insecure system user on **target1.ine.local**.
- **Flag 3:** Identify and exploit the vulnerable plugin used by the web application running on **target2.ine.local** and retrieve the **flag3.txt** file from the root directory.
- **Flag 4:** Further, identify and compromise a system user requiring no authentication on **target2.ine.local**.

The following wordlists will be useful:

- /usr/share/nmap/nselib/data/wp-plugins.lst
- /usr/share/metasploit-framework/data/wordlists/unix_passwords.txt

# Tools

- Nmap
- Hydra
- Dirb
- Python3
- Metasploit

![0cd5f655dcb0901618e860361251be99.png](resources/0cd5f655dcb0901618e860361251be99.png)

We’ve now entered the exploitation phase of our journey. This stage focuses on leveraging identified vulnerabilities to gain access and demonstrate potential risks.

Let’s begin with the first question. Both of the initial questions are related to the same host, `target1.ine.local`.

**Flag.1 Identify and exploit the vulnerable web application running on target1.ine.local and retrieve the flag from the root directory. The credentials admin:password1 may be useful.**

As usual, we begin with **Nmap** to scan for open ports and services using the following command `namp -sC -sV target1.ine.local` .

This scan helps us identify potential entry points by detecting running services and their versions. From here, we analyze the results and proceed with exploitation.

cat /etc/hosts

Both of the initial questions are related to the same host, `target1.ine.local`.

nmap -sC -sV target1.ine.local

![503c4ae7128b1b48ab1d04dd6fa7bc14.png](resources/503c4ae7128b1b48ab1d04dd6fa7bc14.png)

From the Nmap scan results, we can see that port 80 is open, indicating that a web server is running on this port.

Let’s navigate to the website in a browser and analyze its content for potential vulnerabilities.

![27a9b5970118f56eb75f765c2d028efb.png](resources/27a9b5970118f56eb75f765c2d028efb.png)

dirb http://target1.ine.local

![1d79c50fb8dabbf4392ce5fd15d95505.png](resources/1d79c50fb8dabbf4392ce5fd15d95505.png)

After examining the website and did the dirb, we can confirm that it is running on **Flatcore** and has a login form. The question provides us with the credentials `admin:password1`.

\[Flag.1 Identify and exploit the vulnerable web application running on target1.ine.local and retrieve the flag from the root directory. The credentials admin:password1 may be useful.\]

We can use these credentials to log in directly, or alternatively, we can attempt to log in via the following endpoint: `http://target1.ine.local/acp/`

![c4aa44dc2a3279932823fb4af7309384.png](resources/c4aa44dc2a3279932823fb4af7309384.png)

After logging in, you will see a dashboard or an admin panel that looks something like this:

![8bf4cd06b2b602dc2147d614b01a2f4e.png](resources/8bf4cd06b2b602dc2147d614b01a2f4e.png)

Now that we have enumerated the application, it’s time to move on to the exploitation phase. Our goal is to gain access to the root directory.

Since the website is running on **Flatcore**, we should check if there are any known exploits available for this CMS. We can do this using the following command:

searchsploit flatcore

This command searches the Exploit-DB database for publicly available exploits related to Flatcore. If an exploit is found, we can analyze its details and attempt to use it for further exploitation.

![d2605938bc6bf0bdc221f423daae24c0.png](resources/d2605938bc6bf0bdc221f423daae24c0.png)

As you can see, there are two available exploits, but neither is present in Metasploit\*\*.\*\* This means we need to execute the exploit manually on our system. Since our goal is to gain access to the root system, we will use the first exploit, which is Remote Code Execution (Authenticated).

To copy the exploit’s Python code into our current working directory, we can use the following command:

searchsploit -m 50262

![0c8fb0a24b43737160b7142d29d251bb.png](resources/0c8fb0a24b43737160b7142d29d251bb.png)

**Note:** `50262` is the exploit ID we are copying from the Exploit-DB database. Once copied, we can analyze and modify it if necessary before executing it.

Before executing the exploit, we should first read and analyze the code to understand how it works. We can use various tools for this, such as: cat, vim, or mousepad, etc.

![c8b6da8e4f46ae3e1c4f4d791c3c726e.png](resources/c8b6da8e4f46ae3e1c4f4d791c3c726e.png)

After reviewing the code, we can determine how to execute the exploit. To run the Python script and attempt exploitation, we use the following command:

python3 50262.py http://target1.ine.local/ admin password1

![7e6f2efc4da5f951cc9fb459bd81fe13.png](resources/7e6f2efc4da5f951cc9fb459bd81fe13.png)

We have successfully logged in using the exploit. Now, to retrieve our first flag, we need to access the **root directory.** First, we list the directory contents using the following command:

ls /

![29d74b484c357239bcbc8c0f42644fb3.png](resources/29d74b484c357239bcbc8c0f42644fb3.png)

And here we have our first flag, which we can read using the command:

cat /flag1.txt

![b0d7117d9393a0dc763e97d481b551a8.png](resources/b0d7117d9393a0dc763e97d481b551a8.png)

FLAG1{442b8d6ad6644f1fb3a24ca3cc2b9506}

**Flag.2 Further, identify and compromise an insecure system user on target1.ine.local.**

To proceed with the compromise, we first need to enumerate the users on the target system. User directories are typically located in the `/home` directory, so let's list its contents using the command: `ls -l /home`

![072c8216f5734e9e8fdbfe174511d523.png](resources/072c8216f5734e9e8fdbfe174511d523.png)

And here we discovered a user named `iamaweakuser`. As the name suggests, this user likely has a weak password.

Since our initial `Nmap` scan revealed that the `SSH` port is open, we can attempt to brute-force the password using `Hydra`.

![0ffa4281b7dec83441c9fcfc767d96b6.png](resources/0ffa4281b7dec83441c9fcfc767d96b6.png)

hydra -l iamaweakuser -P /usr/share/metasploit-framework/data/wordlists/unix_passwords.txt target1.ine.local ssh

![23c770ba5f3ffbe4be5838209f20c8fc.png](resources/23c770ba5f3ffbe4be5838209f20c8fc.png)

So now, we have the password. Let’s log in to the SSH service using the command:

ssh iamaweakuser@target1.ine.local

![f93a4de2e68d84173e5e6647b00d1bf9.png](resources/f93a4de2e68d84173e5e6647b00d1bf9.png)

To list the contents, type `ls`, and to read the flag, use `cat flag2.txt`. Here we got our second flag!

![37d26262134fba0420dcdd66dcc8c768.png](resources/37d26262134fba0420dcdd66dcc8c768.png)

FLAG2{effd6cf2db0b47f6a504a464274dd729}

Now, the last two questions are related to another target, `target2.ine.local`.

**Flag.3 Identify and exploit the vulnerable plugin used by the web application running on target2.ine.local and retrieve the flag3.txt file from the root directory.**

This flag took more time for me because, at a certain point, I was confused about which exploit to use.

As usual, we start with an Nmap scan using our basic command

nmap -sC -sV target2.ine.local

![1661986472bca0986e71c1b216fdb78e.png](resources/1661986472bca0986e71c1b216fdb78e.png)

So, port 80 is open. Let’s navigate to the website.

Press enter or click to view image in full size

![d0a3e90beaff089b93fdb403506bb509.png](resources/d0a3e90beaff089b93fdb403506bb509.png)

![0e12dbcf170314e8b8145b0a91579627.png](resources/0e12dbcf170314e8b8145b0a91579627.png)

And after analyzing, we can confirm that this website is running on `WordPress`. Our next step is to enumerate the vulnerable plugin.

Since it’s a `WordPress` site, our first instinct is to run `wpscan`

wpscan --url http://target2.ine.local/

![03a56017455c8c9a591547dafce1521d.png](resources/03a56017455c8c9a591547dafce1521d.png)

but unfortunately, it didn't reveal anything interesting related to plugins.

To dig deeper, I ran Nikto using the command: nikto -h target2.ine.local

![815b0e4c6dd4b1811cf84cb9181c87f9.png](resources/815b0e4c6dd4b1811cf84cb9181c87f9.png)

And here, we discovered a plugin named `Akismet`, but after enumeration, it turned out to be not vulnerable.

Next, I attempted to brute-force the plugin directory using the following command:

gobuster dir -u http://target2.ine.local/wp-content/plugins/ -w /usr/share/nmap/nselib/data/wp-plugins.lst

![c088f96529b5d47d756b1dd42b430959.png](resources/c088f96529b5d47d756b1dd42b430959.png)

So now, we found another plugin named **Duplicator**. Let’s search for its vulnerabilities using

searchsploit duplicator

![88491cdaa9d5e269ce6f1b75dc561a60.png](resources/88491cdaa9d5e269ce6f1b75dc561a60.png)

So there are multiple exploits available. One of them is an arbitrary file read exploit in Metasploit.

Let’s use it by running msfconsole and search that particular module.

msfconsole

search duplicator

![808b50c8b74760422ce1fefa47fc52dd.png](resources/808b50c8b74760422ce1fefa47fc52dd.png)

Interact with the module by typing `use 1` and then `options` to list the required parameters.

![2e6a5187ce494a378ad49989c19462e3.png](resources/2e6a5187ce494a378ad49989c19462e3.png)

So we need to set only `RHOSTS` as `target2.ine.local` and run the exploit.

set RHOSTS target2.ine.local

![c245e66c2f0e187a94bb49bcf77aa396.png](resources/c245e66c2f0e187a94bb49bcf77aa396.png)

And the exploit executed successfully. Now, the third flag is in the root directory. Let’s read it by setting the `FILEPATH` to `/flag3.txt`.

![953419ddb6eb4b1cc16ccc2f2aa9c74f.png](resources/953419ddb6eb4b1cc16ccc2f2aa9c74f.png)

And here we got our third flag which is:

FLAG3{177eafc58a0d453797b86fd142a0803e}

**Flag.4 Further, identify and compromise a system user requiring no authentication on target2.ine.local.**

**![77f73dcb101a67328913e9c2b0c6b456.png](resources/77f73dcb101a67328913e9c2b0c6b456.png)**

While running `/etc/passwd` during the arbitrary file read, we discovered a user named **iamacrazyfreeuser**, who has direct access to bash.

![6ab212ac16b15690d588b40309070ace.png](resources/6ab212ac16b15690d588b40309070ace.png)

![886f74afdefbea67278d856f38283f8e.png](resources/886f74afdefbea67278d856f38283f8e.png)

From the Nmap scan, we know that SSH is open, so let’s try connecting using

ssh iamacrazyfreeuser@target2.ine.local

![aef0fd3e9f7f373f7dd253a0c4401d31.png](resources/aef0fd3e9f7f373f7dd253a0c4401d31.png)

And we got access **without any password**, Now, for our last flag, we need to list the files

![1e2b54d5c9171fa095b1c63b23e4fd2e.png](resources/1e2b54d5c9171fa095b1c63b23e4fd2e.png)

FLAG4{29179543c5dc4a53a6f1ec0540da9dc7}

![f6b6d2144fa695bf7177a7a2c7025f43.png](resources/f6b6d2144fa695bf7177a7a2c7025f43.png)
